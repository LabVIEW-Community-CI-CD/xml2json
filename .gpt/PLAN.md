# PLAN.md
| ID   | Feature / Requirement                                  | Implementation Plan                                                                                                                                                                                 |
|------|--------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **F-1** | Input processing (accept one `.vipb` file)            | - Parse command-line arguments (using `args[]` or a CLI library). Expect exactly one positional argument.<br>- Verify that the input file exists and is readable (e.g., using `File.Exists(path)`). If not, write an error to `stderr` and exit with a non-zero code. |
| **F-2** | XML→JSON conversion (parse all data)                 | - Use .NET’s XML libraries (e.g., `XmlDocument` or `XDocument`) to load the `.vipb` file.<br>- Traverse all XML elements and attributes and build a corresponding JSON structure (e.g., using objects or dictionaries). Include all elements, values, and attributes in the JSON.<br>- Serialize this structure to JSON using `System.Text.Json` or a similar library. |
| **F-3** | Output routing (write JSON to stdout or file)        | - After conversion, obtain the JSON string.<br>- If `--output <file>` is specified, write the JSON to that file (e.g., `File.WriteAllText(outputPath, jsonString)`).<br>- Otherwise, write the JSON to standard output (e.g., `Console.WriteLine(jsonString)`).<br>- Ensure JSON is emitted exactly once (only to file or stdout). |
| **F-4** | Help/usage (`-h/--help`)                              | - Detect if `-h` or `--help` appears in the arguments. If so, print usage information (tool syntax and options) to `stdout` and exit with code 0.<br>- The usage information can be a predefined string or supplied by a CLI parsing library. |
| **F-5** | Error handling (missing file, invalid XML, runtime errors) | - Wrap processing in try-catch.<br>- If the input file is missing or unreadable, print **“Input file not found”** to `stderr` and exit non-zero.<br>- If XML parsing fails (catch `XmlException`), print **“Invalid VIPB format”** to `stderr` and exit non-zero.<br>- Catch any other exception, print a generic error message to `stderr`, and exit non-zero.<br>- In all error cases, do not output any JSON. |
| **F-6** | Exit codes                                            | - On success, return exit code `0`.<br>- On any failure (invalid args, missing file, parse error, exception), return a non-zero exit code (e.g., `1`).<br>- Ensure the help case (`-h`) returns exit code `0` as well. |
